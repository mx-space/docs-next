(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{9294:function(s,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/extra",function(){return r(1289)}])},8076:function(s,e,r){"use strict";var l=r(1527),n=r(5903),o=r.n(n);r(959);var i=r(7634),a=r(1689);let c=(0,l.jsxs)("span",{className:"jsx-ef39c6053f12c009",children:[(0,l.jsx)("img",{height:40,src:"https://cdn.jsdelivr.net/gh/mx-space/.github@main/uwu.png",className:"jsx-ef39c6053f12c009"}),(0,l.jsx)("span",{className:"jsx-ef39c6053f12c009",children:"Mix Space"}),(0,l.jsx)(o(),{id:"ef39c6053f12c009",children:"span.jsx-ef39c6053f12c009{padding:.5rem .5rem .5rem 0;-webkit-mask-image:-webkit-linear-gradient(30deg,black 25%,rgba(0,0,0,.2)50%,black 75%);mask-image:-webkit-linear-gradient(30deg,black 25%,rgba(0,0,0,.2)50%,black 75%);mask-image:-moz-linear-gradient(30deg,black 25%,rgba(0,0,0,.2)50%,black 75%);mask-image:-o-linear-gradient(30deg,black 25%,rgba(0,0,0,.2)50%,black 75%);mask-image:linear-gradient(60deg,black 25%,rgba(0,0,0,.2)50%,black 75%);-webkit-mask-size:400%;mask-size:400%;-webkit-mask-position:0%;mask-position:0%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;font-size:16px;font-weight:600}img.jsx-ef39c6053f12c009{margin-right:8px;height:40px}span.jsx-ef39c6053f12c009:hover{-webkit-mask-position:100%;mask-position:100%;-webkit-transition:mask-position 1s ease,-webkit-mask-position 1s ease;-moz-transition:mask-position 1s ease,-webkit-mask-position 1s ease;-o-transition:mask-position 1s ease,-webkit-mask-position 1s ease;transition:mask-position 1s ease,-webkit-mask-position 1s ease}"})]}),t={logo:c,head:function(){let{title:s}=(0,i.ZR)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("link",{rel:"dns-prefetch",href:"//pan.vinua.cn"}),(0,l.jsx)("meta",{name:"msapplication-TileColor",content:"#fff"}),(0,l.jsx)("meta",{name:"theme-color",content:"#fff"}),(0,l.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,l.jsx)("meta",{httpEquiv:"Content-Language",content:"en"}),(0,l.jsx)("meta",{name:"description",content:"A flexible, modular CMS Blog System."}),(0,l.jsx)("meta",{name:"og:description",content:"A flexible, modular CMS Blog System."}),(0,l.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,l.jsx)("meta",{name:"twitter:site:domain",content:"mog.js.org"}),(0,l.jsx)("meta",{name:"twitter:url",content:"https://mog.js.org"}),(0,l.jsx)("meta",{name:"og:title",content:s?s+" | Mix Space":"Mix Space"}),(0,l.jsx)("meta",{name:"apple-mobile-web-app-title",content:"Mix Space"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.svg",type:"image/svg+xml"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.png",type:"image/png"})]})},project:{link:"https://github.com/mx-space/core"},docsRepositoryBase:"https://github.com/mx-space/docs/blob/main",footer:{text:(0,l.jsx)("div",{className:"flex w-full flex-col items-center sm:items-start",children:(0,l.jsxs)("p",{className:"text-xs",children:["\xa9 ",new Date().getFullYear()," This project is licensed under AGPLv3 with additional terms, and this documentation is licensed under CC BY 4.0. All licensed. 2021-present Mix Space Team"]})})},useNextSeoProps(){let{asPath:s}=(0,a.useRouter)();if("/"!==s)return{titleTemplate:"%s | Mix Space"}},editLink:{text:"Edit this page on GitHub →"},banner:{key:"theme-shiro",text:(0,l.jsx)("a",{href:"https://mx-space.js.org/themes/shiro",target:"_blank",children:"\uD83C\uDFA8 New Mix Space theme `Shiro` is released. Read more →"})}};e.Z=t},1289:function(s,e,r){"use strict";r.r(e);var l=r(1527),n=r(985),o=r(7634),i=r(8076);r(9941),r(1365);var a=r(6736);r(8823);var c=r(5032);let t={MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,a.ah)(),s.components);return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(h,{...s})}):h(s)},pageOpts:{filePath:"pages/docs/extra.mdx",route:"/docs/extra",headings:[{depth:1,value:"拓展内容",id:"拓展内容"},{depth:2,value:"反向代理",id:"反向代理"},{depth:3,value:"双域名",id:"双域名"},{depth:3,value:"单域名",id:"单域名"},{depth:2,value:"配置其他 Redis 服务",id:"配置其他-redis-服务"},{depth:3,value:"对于进阶部署",id:"对于进阶部署"},{depth:2,value:"配置其他 MongoDB 服务",id:"配置其他-mongodb-服务"},{depth:3,value:"对于进阶部署",id:"对于进阶部署-1"}],pageMap:[{kind:"Meta",data:{index:{type:"page",title:"Mix Space",display:"hidden",theme:{layout:"raw"}},docs:{type:"page",title:"部署文档"},usage:{type:"page",title:"使用指南"},themes:{type:"page",title:"前端主题",theme:{layout:"raw"}},development:{title:"系统开发",type:"page"}}},{kind:"Folder",name:"development",route:"/development",children:[{kind:"Meta",data:{index:"前言",frontend:"前端开发指南",admin:"后台单独部署"}},{kind:"MdxPage",name:"admin",route:"/development/admin"},{kind:"MdxPage",name:"frontend",route:"/development/frontend"},{kind:"MdxPage",name:"index",route:"/development"}]},{kind:"Folder",name:"docs",route:"/docs",children:[{kind:"Meta",data:{index:"引言",features:"主要功能","-- advanced":{type:"separator",title:"部署"},docker:"Docker 部署",scripts:"预设脚本部署",advanced:"进阶部署",extra:"相关内容",community:"社区分享"}},{kind:"MdxPage",name:"advanced",route:"/docs/advanced"},{kind:"MdxPage",name:"community",route:"/docs/community"},{kind:"MdxPage",name:"docker",route:"/docs/docker"},{kind:"MdxPage",name:"extra",route:"/docs/extra"},{kind:"MdxPage",name:"features",route:"/docs/features"},{kind:"MdxPage",name:"index",route:"/docs",frontMatter:{title:"引言"}},{kind:"MdxPage",name:"scripts",route:"/docs/scripts"}]},{kind:"MdxPage",name:"index",route:"/",frontMatter:{title:"Mix Space - An Alternative Personal Space."}},{kind:"Folder",name:"themes",route:"/themes",children:[{kind:"Meta",data:{index:{title:"主题目录"},shiro:{title:"部署 Shiro 主题",theme:{layout:"default"}},kami:{title:"部署 Kami 主题",theme:{layout:"default"}},yun:{title:"部署 Yun 主题",theme:{layout:"default"}}}},{kind:"MdxPage",name:"index",route:"/themes",frontMatter:{title:"前端主题"}},{kind:"MdxPage",name:"kami",route:"/themes/kami"},{kind:"Folder",name:"shiro",route:"/themes/shiro",children:[{kind:"Meta",data:{index:"部署主题",extra:"额外功能",config:"配置项"}},{kind:"MdxPage",name:"config",route:"/themes/shiro/config"},{kind:"MdxPage",name:"extra",route:"/themes/shiro/extra"},{kind:"MdxPage",name:"index",route:"/themes/shiro"}]},{kind:"MdxPage",name:"yun",route:"/themes/yun"}]},{kind:"Folder",name:"usage",route:"/usage",children:[{kind:"Meta",data:{index:"使用指南","-- built-in":{type:"separator",title:"官方指南"},serverless:"云函数",xlog:"xLog 集成",search:"Algolia Search",backup:"备份与回滚",update:"更新 Mix Space",security:"Key 加密与安全性","-- community":{type:"separator",title:"社区使用指南"}}},{kind:"MdxPage",name:"backup",route:"/usage/backup"},{kind:"MdxPage",name:"index",route:"/usage"},{kind:"MdxPage",name:"search",route:"/usage/search"},{kind:"MdxPage",name:"security",route:"/usage/security"},{kind:"MdxPage",name:"serverless",route:"/usage/serverless"},{kind:"MdxPage",name:"update",route:"/usage/update"},{kind:"MdxPage",name:"xlog",route:"/usage/xlog"}]}],flexsearch:{codeblocks:!1},title:"拓展内容"},pageNextRoute:"/docs/extra",nextraLayout:o.ZP,themeConfig:i.Z};function h(s){let e=Object.assign({h1:"h1",p:"p",h2:"h2",strong:"strong",h3:"h3",code:"code",pre:"pre",span:"span",ul:"ul",li:"li",a:"a"},(0,a.ah)(),s.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.h1,{children:"拓展内容"}),"\n","\n",(0,l.jsx)(c.UW,{type:"warning",emoji:"⚠️",children:(0,l.jsx)(e.p,{children:"此部分内容将说明一些额外的操作流程，根据自己需要进行配置。"})}),"\n",(0,l.jsx)(e.h2,{id:"反向代理",children:"反向代理"}),"\n",(0,l.jsx)(e.p,{children:"在这里提供双域名（前端和后端各用一个域名）与单域名（前后端共用一个域名）的配置步骤。"}),"\n",(0,l.jsx)(e.p,{children:"当然不管使用哪种方法，都建议用控制面板（如宝塔、1Panel 等）的使用面板提供的反代功能单独粘贴对应的反代配置部分完成配置（需要删掉开头和结尾的 server 块），手写反代配置的大佬随意。"}),"\n",(0,l.jsxs)(e.p,{children:["另外，不管是前端还是后端的域名，都需要",(0,l.jsx)(e.strong,{children:"配置好 HTTPS 证书"}),"以保证网站能正常访问。"]}),"\n",(0,l.jsx)(e.h3,{id:"双域名",children:"双域名"}),"\n",(0,l.jsxs)(e.p,{children:["这里假定前端域名为 ",(0,l.jsx)(e.code,{children:"www.example.com"}),"，后端为 ",(0,l.jsx)(e.code,{children:"server.example.com"}),"。"]}),"\n",(0,l.jsxs)(e.p,{children:["以下是后端 ",(0,l.jsx)(e.code,{children:"server.example.com"})," 反代配置部分"]}),"\n",(0,l.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理开始"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## WebSocket"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /socket.io {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/socket.io; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"upgrade"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_buffering "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"off;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_http_version "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"1.1; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Cache-Control no-cache; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## Others"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Cache $upstream_cache_status; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理结束"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(e.p,{children:["前端 ",(0,l.jsx)(e.code,{children:"www.example.com"})," 反代部分"]}),"\n",(0,l.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"server{"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\.(gif|png|jpg|css|js|woff|woff2)$ "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" expires "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"30d;"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\/(feed|sitemap|atom.xml) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/$1;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Cache $upstream_cache_status;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Cache-Control max-age=60;"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Cache $upstream_cache_status;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Cache-Control no-cache;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_intercept_errors "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"on;"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(c.UW,{type:"info",children:[(0,l.jsx)(e.p,{children:"如果您使用此部分示例配置 Nginx 反向代理，您的："}),(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["API 地址为 ",(0,l.jsx)(e.code,{children:"https://server.example.com/api/v2"})]}),"\n",(0,l.jsxs)(e.li,{children:["前端（Kami/Shiro）地址为 ",(0,l.jsx)(e.code,{children:"https://www.example.com"})]}),"\n",(0,l.jsxs)(e.li,{children:["GateWay 为 ",(0,l.jsx)(e.code,{children:"https://server.example.com"})]}),"\n",(0,l.jsxs)(e.li,{children:["本地后台为 ",(0,l.jsx)(e.code,{children:"https://server.example.com/proxy/qaqdmin"})]}),"\n"]})]}),"\n",(0,l.jsx)(e.h3,{id:"单域名",children:"单域名"}),"\n",(0,l.jsx)(e.p,{children:"以下配置文件以 Nginx 为例，请自行修改 SSL 证书路径以及自己的网站域名。"}),"\n",(0,l.jsxs)(e.p,{children:["若使用 Caddy 进行配置可参考 ",(0,l.jsx)(e.a,{href:"https://github.com/mx-space/docker/blob/master/Caddyfile.example",children:"Caddyfile 文件示例"}),"进行相应修改。"]}),"\n",(0,l.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理开始 "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## WebSocket 地址"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /socket.io {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Upgrade"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_buffering "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"off; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-Proto $scheme; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/socket.io; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## API 地址"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /api/v2 {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/api/v2; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 简读 render 地址"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /render {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/render; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## Kami 地址"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 后台地址"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /proxy {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/proxy;"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /qaqdmin {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/proxy/qaqdmin;"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## RSS 地址"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\/(feed|sitemap|atom.xml) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/$1; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理结束"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.p,{children:"完整示例如下"}),"\n",(0,l.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" listen "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"80;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" listen "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"443 ssl http2 ; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 绑定域名 "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" server_name "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"www.example.com; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" index "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"index.html; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-Host $server_name; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"upgrade"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" error_log "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/log/error.log;"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" access_log "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/log/access.log; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /socket.io {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Upgrade"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-Proto $scheme; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/socket.io; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /api/v2 {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/api/v2; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /render {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/render; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /qaqdmin {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/proxy/qaqdmin;"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /proxy {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/proxy;"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\/(feed|sitemap|atom.xml) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/$1; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_certificate "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/ssl/fullchain.pem; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_certificate_key "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/ssl/privkey.pem; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_protocols "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TLSv1.3 TLSv1.2 TLSv1.1 TLSv1; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_ciphers "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_prefer_server_ciphers "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"on; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_session_cache "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"shared:SSL:10m; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_session_timeout "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"10m; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" error_page "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"497 https://$host$request_uri; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" limit_conn "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"perserver "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"300"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" limit_conn "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"perip "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"25"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" limit_rate "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"512k; "})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(c.UW,{type:"info",children:[(0,l.jsx)(e.p,{children:"如果您使用此部分示例配置 Nginx 反向代理，您的："}),(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["API 地址为 ",(0,l.jsx)(e.code,{children:"https://www.example.com/api/v2"})]}),"\n",(0,l.jsxs)(e.li,{children:["前端（Kami/Shiro）地址为 ",(0,l.jsx)(e.code,{children:"https://www.example.com"})]}),"\n",(0,l.jsxs)(e.li,{children:["GateWay 为 ",(0,l.jsx)(e.code,{children:"https://www.example.com"})]}),"\n",(0,l.jsxs)(e.li,{children:["本地后台为 ",(0,l.jsx)(e.code,{children:"https://www.example.com/proxy/qaqdmin"})]}),"\n"]})]}),"\n",(0,l.jsx)(e.h2,{id:"配置其他-redis-服务",children:"配置其他 Redis 服务"}),"\n",(0,l.jsxs)(e.p,{children:["如果你需要使用来自 (远端 / 非容器) 的 Redis 服务，你可以通过使用 ",(0,l.jsx)(e.code,{children:"argv"})," 来动态传入对应的配置项。"]}),"\n",(0,l.jsx)(e.p,{children:"支持传入如下值："}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"redis_host"})," Redis 服务地址，域名、IP 都可以"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"redis_port"})," Redis 服务端口"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"redis_password"})," Redis 服务密码"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"在默认情况下，我们认为这样已经足够了。"}),"\n",(0,l.jsx)(e.h3,{id:"对于进阶部署",children:"对于进阶部署"}),"\n",(0,l.jsxs)(e.p,{children:["针对这种部署方式，我们可以修改 ",(0,l.jsx)(e.code,{children:"ecosystem.config.js"})," 在 12 行，也就是 ",(0,l.jsx)(e.code,{children:"script"})," 这一项，添加你需要传入的值，如下所示："]}),"\n",(0,l.jsx)(e.pre,{"data-language":"diff","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"diff","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { cpus } = require('os')"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { execSync } = require('child_process')"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const nodePath = execSync(`npm root --quiet -g`, { encoding: 'utf-8' }).split("})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  '\\n',"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")[0]"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const cpuLen = cpus().length"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"module.exports = {"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  apps: ["})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    {"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      name: 'mx-server',"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"#EF6270"},children:"-     script: 'out/index.js,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"#4BB74A"},children:"+     script: 'out/index.js --redis_host=远端地址 --redis_password=redis?passwd',"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      autorestart: true,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      exec_mode: 'cluster',"})})]})}),"\n",(0,l.jsx)(e.p,{children:"当你修改完成，你需要重新构建，并重启服务："}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"bundle"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"prod:pm2"})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"配置其他-mongodb-服务",children:"配置其他 MongoDB 服务"}),"\n",(0,l.jsxs)(e.p,{children:["如果你需要使用来自 (远端 / 非容器) 的 MongoDB 服务，你可以通过使用 ",(0,l.jsx)(e.code,{children:"argv"})," 来动态传入对应的配置项。"]}),"\n",(0,l.jsx)(e.p,{children:"支持传入如下值："}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"collection_name"})," 数据库集合名字"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"db_host"})," MongoDB 服务地址，域名、IP 都可以"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"db_port"})," MongoDB 服务端口"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"db_user"})," MongoDB 服务用户名"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"db_password"})," MongoDB 服务密码"]}),"\n"]}),"\n",(0,l.jsx)(c.UW,{type:"warning",emoji:"⚠️",children:(0,l.jsx)(e.p,{children:"如果你需要使用密码登录，你不仅仅需要传入 password，还需要传入 user，建议你对数据库集合划分好用户权限"})}),"\n",(0,l.jsx)(e.h3,{id:"对于进阶部署-1",children:"对于进阶部署"}),"\n",(0,l.jsxs)(e.p,{children:["和 Redis 一样，我们可以修改 ",(0,l.jsx)(e.code,{children:"ecosystem.config.js"})," 在 12 行，也就是 ",(0,l.jsx)(e.code,{children:"script"})," 这一项，添加你需要传入的值，如下所示："]}),"\n",(0,l.jsx)(e.pre,{"data-language":"diff","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"diff","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { cpus } = require('os')"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { execSync } = require('child_process')"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const nodePath = execSync(`npm root --quiet -g`, { encoding: 'utf-8' }).split("})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  '\\n',"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")[0]"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const cpuLen = cpus().length"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"module.exports = {"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  apps: ["})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    {"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      name: 'mx-server',"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"#4BB74A"},children:"+     script: 'out/index.js --db_host=远端地址 --db_user=mongodb-test --db_password=db?passwd',"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      autorestart: true,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      exec_mode: 'cluster',"})})]})}),"\n",(0,l.jsx)(e.p,{children:"当你修改完成，你需要重新构建，并重启服务："}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"bundle"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"prod:pm2"})]})]})})]})}e.default=(0,n.j)(t)}},function(s){s.O(0,[163,774,888,179],function(){return s(s.s=9294)}),_N_E=s.O()}]);